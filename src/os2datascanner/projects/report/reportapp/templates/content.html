{% load i18n %}
{% load l10n %}

<div class="content-header">

  {% if "/remediator" in request.path and not user.account.is_remediator %}
    {#  Then we don't need any title or count.  #}
  {% else %}
    <h1 class="page-title">{% trans "Results" %}</h1>
    {{ page_obj.paginator.count }} {% trans "results" %}
  {% endif %}

  {# the loading-circle #}
  <svg class="page-indicator"
       id="report-page-indicator"
       viewbox="0 0 100 100">
    <circle id="circle" cx="50" cy="50" r="45"></circle>
  </svg>

  {% if "/undistributed" in request.path %}
    <div id="distribute-container"
         class="distribute dropdown"
         name="distribute-container">
      <label class="block-label" for="distribute-to">{% trans "Distribute matches to users from" %}</label>
      {% if undistributed_scannerjobs.count >= 10 %}
        <div class="search_field_wrapper wide">
          <input type="search"
                 id="search-bar"
                 placeholder="{% trans "Search Scannerjob" %}">
        </div>
      {% endif %}
      <select id="distribute-to" name="distribute-to" multiple>
        {% for scan in undistributed_scannerjobs %}
          {% comment %} Check here for scannerjobs with the "only notify superadmin"-setting {% endcomment %}
          <option value="{{ scan.scanner_job_pk|unlocalize }}">{{ scan.scanner_job_name }} ({{ scan.total }})</option>
        {% endfor %}
      </select>
      <button class="button button--cta"
              id="distribute-matches"
              name="distribute-matches"
              disabled
              hx-confirm="{% trans "Are you sure you want to distribute matches to the users? This action cannot be reverted." %}"
              hx-target="this"
              hx-trigger="click"
              hx-swap="afterend"
              hx-post="{% url "distribute" %}"
              hx-include="[name='distribute-to']"
              hx-push-url="false">{% trans "Distribute" %}</button>
    </div>
  {% endif %}
</div>

{% if "/remediator" in request.path and not user.account.is_remediator %}
  {% include "error_pages/remediator-error-page.html" %}
{% else %}
  {% include "components/reports/filters.html" %}
  {% if page_obj.paginator.count == 0 %}
    <p class="no-results">{% trans "No results were found" %}</p>
  {% else %}
    {% include "components/reports/match_table.html" %}
  {% endif %}
{% endif %}

{# Snackbar for popup messages #}
{% include 'components/snackbar.html' with messages=messages %}
